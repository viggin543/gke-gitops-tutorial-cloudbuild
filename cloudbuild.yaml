#  gcloud builds submit --tag="gcr.io/adikastyle-dev/hello-cloudbuild:${COMMIT_ID}" .
steps:
  - name: 'gcr.io/cloud-builders/go'
    id: Test
    args:
      - 'test'
      - './...'
  - name: 'gcr.io/cloud-builders/go'
    id: Compile
    args: ['build', './...']
  - name: 'bash'
    id: Log
    args: ['ls', '-la']
  - name: 'gcr.io/cloud-builders/docker'
    id: Build
    args:
      - 'build'
      - '-t'
      - 'gcr.io/$PROJECT_ID/hello-cloudbuild:$SHORT_SHA'
      - '.'
  - name: 'gcr.io/cloud-builders/docker'
    id: Push
    args:
      - 'push'
      - 'gcr.io/$PROJECT_ID/hello-cloudbuild:$SHORT_SHA'